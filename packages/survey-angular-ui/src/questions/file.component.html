<div [class]="model.fileRootCss" #contentElement>
  <input [class]="model.cssClasses.fileInput" *ngIf="!model.isReadOnly && model.hasFileUI" tabindex="-1" type="file"
    [attr.id]="model.inputId" (change)="model.doChange($event)" [attr.aria-required]="model.ariaRequired"
    [attr.aria-label]="model.ariaLabel" [attr.aria-invalid]="model.ariaInvalid"
    [attr.aria-describedby]="model.ariaDescribedBy" [attr.multiple]="model.multipleRendered"
    [attr.title]="model.inputTitle" [attr.accept]="model.acceptedTypes" [attr.capture]="model.renderCapture" />
  <input *ngIf="model.isReadOnly" type="file" disabled [class]="model.getReadOnlyFileCss()" [attr.id]="model.inputId"
    [attr.multiple]="model.multipleRendered" [attr.placeholder]="model.title" style="color: transparent" />
  <div [class]="model.cssClasses.dragArea" (dragenter)="model.onDragEnter($event)" (drop)="model.onDrop($event)"
    (dragover)="model.onDragOver($event)" (dragleave)="model.onDragLeave($event)">
    <div [class]="model.getFileDecoratorCss()" *ngIf="model.showFileDecorator">
      <span [class]="model.cssClasses.dragAreaPlaceholder">{{ model.renderedPlaceholder }}</span>
      <div [class]="model.cssClasses.wrapper">
        <sv-ng-choose-file-btn [data]="{ question: model }" *ngIf="model.showChooseButton"></sv-ng-choose-file-btn>
        <sv-ng-action-bar [model]="model.actionsContainer" *ngIf="model.actionsContainerVisible"></sv-ng-action-bar>
        <span [class]="model.cssClasses.noFileChosen" *ngIf="model.isEmpty()">{{ model.noFileChosenCaption }}</span>
      </div>
    </div>
    <ng-container *ngIf="model.showLoadingIndicator">
      <div [class]="model.cssClasses.loadingIndicator">
        <sv-ng-loading-indicator></sv-ng-loading-indicator>
      </div>
    </ng-container>
    <ng-container *ngIf="model.isPlayingVideo">
      <ng-container *ngTemplateOutlet="fileVideo"></ng-container>
    </ng-container>
    <ng-container *ngIf="model.showRemoveButton">
      <ng-container *ngTemplateOutlet="fileCleanButton; context: { css: model.showRemoveButton }"></ng-container>
    </ng-container>
    <ng-container *ngIf="model.allowShowPreview">
      <ng-container *ngTemplateOutlet="filePreview"></ng-container>
    </ng-container>
    <ng-container *ngIf="model.showRemoveButtonBottom">
      <ng-container *ngTemplateOutlet="fileCleanButton; context: { css: model.showRemoveButtonBottom }"></ng-container>
    </ng-container>
    <sv-action-bar *ngIf="model.fileNavigatorVisible" [model]="model.fileNavigator"></sv-action-bar>
  </div>
</div>
<ng-template #filePreview>
  <div [class]="model.cssClasses.fileList || undefined">
    <span *ngFor="let val of model.previewValue; index as index; trackBy: trackFilesFn"
      [visible]="val && model.isPreviewVisible(index)" [class]="model.cssClasses.preview">
      <div *ngIf="val.name && model.cssClasses.fileSign" [class]="model.cssClasses.fileSign">
        <a (click)="model.doDownloadFile($event, val)" [attr.href]="val.content | safeUrl" [attr.title]="val.name"
          [attr.download]="val.name" [style.width]="model.imageWidth">{{ val.name }}</a>
      </div>
      <div [class]="model.cssClasses.imageWrapper">
        <img *ngIf="model.canPreviewImage(val)" [attr.src]="val.content | safeUrl" [style.height]="model.imageHeight"
          [style.width]="model.imageWidth" alt="File preview" />
        <svg *ngIf="model.defaultImage(val)" [iconName]="model.cssClasses.defaultImageIconId"
          [partCss]="model.cssClasses.defaultImage" [size]="'auto'" sv-ng-svg-icon></svg>
        <div *ngIf="val.name && !model.isReadOnly" [class]="model.getRemoveButtonCss()"
          (click)="model.doRemoveFile(val)">
          <span [class]="model.cssClasses.removeFile">{{ model.removeFileCaption }}</span>
          <svg *ngIf="model.cssClasses.removeFileSvgIconId" [title]="model.removeFileCaption"
            [partCss]="model.cssClasses.removeFileSvg" [iconName]="model.cssClasses.removeFileSvgIconId" [size]="'auto'"
            sv-ng-svg-icon></svg>
        </div>
      </div>
      <div *ngIf="val.name && model.cssClasses.fileSignBottom" [class]="model.cssClasses.fileSignBottom">
        <a (click)="model.doDownloadFile($event, val)" [attr.href]="val.content | safeUrl" [attr.title]="val.name"
          [attr.download]="val.name" [style.width]="model.imageWidth">{{ val.name }}</a>
      </div>
    </span>
  </div>
</ng-template>
<ng-template #fileCleanButton let-css="css">
  <button type="button" [class]="css" (click)="model.doClean()">
    <span>{{ model.clearButtonCaption }}</span>
    <svg *ngIf="model.cssClasses.removeButtonIconId" [iconName]="model.cssClasses.removeButtonIconId" [size]="'auto'"
      [title]="model.clearButtonCaption" sv-ng-svg-icon></svg>
  </button>
</ng-template>
<ng-template #fileVideo>
  <div [class]="model.cssClasses.videoContainer">
    <sv-ng-action [model]="model.changeCameraAction"></sv-ng-action>
    <sv-ng-action [model]="model.closeCameraAction"></sv-ng-action>
    <video autoplay playsinline [attr.id]="model.videoId" [class]="model.cssClasses.video"></video>
    <sv-ng-action [model]="model.takePictureAction"></sv-ng-action>
  </div>
</ng-template>